<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <title>–ú–æ—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <style>
    :root{
      --bg0:#070A12;
      --bg1:#0B1630;
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.68);
      --shadow: 0 18px 60px rgba(0,0,0,.45);

      --radius: 22px;
      --radius2: 16px;

      /* —Å—Ç–∞—Ç–∏—á–Ω—ã–π –º—è–≥–∫–∏–π —Å–≤–µ—Ç —Ñ–æ–Ω–∞ */
      --mx: 50%;
      --my: 30%;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      color: var(--text);
      overflow-x:hidden;

      background:
        radial-gradient(900px 520px at var(--mx) var(--my), rgba(124,92,255,.20), transparent 55%),
        radial-gradient(700px 500px at 20% 90%, rgba(35,213,255,.12), transparent 58%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
    }

    /* Canvas background */
    #bg{
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      display:block;
    }
    .vignette{
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events:none;
      background: radial-gradient(1200px 800px at 50% 30%, transparent 35%, rgba(0,0,0,.45) 90%);
      mix-blend-mode: multiply;
    }

    .wrap{
      min-height: 100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 28px 14px 44px;
      position: relative;
      z-index: 1; /* –≤—ã—à–µ –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–≥–æ —Ñ–æ–Ω–∞ */
    }

    /* –û–∫–Ω–æ */
    .card{
      width: min(820px, 100%);
      background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.05));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow:hidden;
      transform-style: preserve-3d;
    }

    .top{
      position:relative;
      padding: 22px 20px 14px;
      display:flex;
      gap: 14px;
      align-items:center;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }

    /* –û–±—ë—Ä—Ç–∫–∞ –ø–æ–¥ —à–∞–ø–∫—É */
    .avatarDecor{
      position: relative;
      flex: 0 0 auto;
      display: inline-block;
      overflow: visible;
    }

    .avatar{
      width: 64px;
      height: 64px;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.18);
      overflow:hidden;
      background:
        radial-gradient(120% 120% at 20% 20%, rgba(255,255,255,.22), transparent 55%),
        linear-gradient(135deg, rgba(124,92,255,.35), rgba(35,213,255,.22));
      display:grid;
      place-items:center;
      position:relative;
      z-index: 2; /* –Ω–∏–∂–µ —à–∞–ø–∫–∏ */
    }
    .avatar span{
      font-weight: 800;
      font-size: 20px;
      letter-spacing: .5px;
      opacity: .95;
      text-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .avatar img{
      width:100%;
      height:100%;
      object-fit:cover;
      object-position:center;
      display:block;
      transform: translateZ(0);
    }

    .title{ flex: 1 1 auto; min-width: 0; }
    h1{
      margin: 0 0 6px;
      font-size: clamp(18px, 2.1vw, 26px);
      line-height: 1.15;
      letter-spacing: .2px;
    }
    .subtitle{
      margin:0;
      color: var(--muted);
      font-size: 13.5px;
      line-height: 1.35;
      min-height: 1em;
    }

    .actions{
      display:flex;
      gap:10px;
      align-items:center;
      flex: 0 0 auto;
      flex-wrap: wrap;
      justify-content:flex-end;
    }

    .pill{
      appearance:none;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.9);
      border-radius: 999px;
      padding: 9px 11px;
      font-size: 13px;
      cursor:pointer;
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
      position:relative;
      overflow:hidden;
      user-select:none;
      white-space: nowrap;
    }
    .pill:hover{ transform: translateY(-2px); background: rgba(255,255,255,.11); border-color: rgba(255,255,255,.22); }
    .pill:active{ transform: translateY(0px) scale(.98); }
    .pill:focus-visible{ outline: 2px solid rgba(124,92,255,.7); outline-offset: 2px; }

    .grid{
      padding: 14px 14px 6px;
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 12px;
    }

    @media (max-width: 860px){
      .grid{ grid-template-columns: 1fr; }
      .top{ padding: 20px 16px 14px; }
    }

    .panel{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      border-radius: var(--radius2);
      padding: 14px;
      transform-style: preserve-3d;
      transition: transform .18s ease;
      position:relative;
      overflow:hidden;
    }

    .panel:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(600px 220px at 20% 10%, rgba(124,92,255,.18), transparent 60%),
        radial-gradient(520px 220px at 80% 0%, rgba(35,213,255,.10), transparent 55%);
      opacity:.8;
      pointer-events:none;
      transform: translateZ(-1px);
    }

    .panel h2{
      margin: 0 0 10px;
      font-size: 13px;
      letter-spacing: .5px;
      text-transform: uppercase;
      color: rgba(255,255,255,.78);
    }

    .links{ display:grid; gap: 10px; }

    .link{
      display:flex;
      gap: 12px;
      align-items:center;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.10);
      text-decoration:none;
      color: var(--text);
      position:relative;
      overflow:hidden;
      transform: translateZ(0);
      transition: transform .18s ease, border-color .18s ease, background .18s ease;
    }
    .link:hover{
      transform: translateY(-2px);
      border-color: rgba(255,255,255,.22);
      background: rgba(255,255,255,.06);
    }
    .link:active{ transform: translateY(0px) scale(.99); }
    .link:focus-visible{ outline: 2px solid rgba(160,120,255,.70); outline-offset: 2px; }

    .link:before{
      content:"";
      position:absolute;
      top:-60%;
      left:-40%;
      width: 60%;
      height: 220%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.20), transparent);
      transform: rotate(25deg);
      opacity:0;
      transition: opacity .25s ease, transform .35s ease;
      pointer-events:none;
    }
    .link:hover:before{
      opacity:1;
      transform: translateX(240%) rotate(25deg);
    }

    .ripple{
      position:absolute;
      border-radius:999px;
      transform: translate(-50%, -50%);
      pointer-events:none;
      background: radial-gradient(circle, rgba(255,255,255,.45), rgba(255,255,255,.12) 40%, transparent 70%);
      width: 12px;
      height: 12px;
      animation: ripple .55s ease-out forwards;
    }
    @keyframes ripple{
      from{ opacity:.9; transform: translate(-50%,-50%) scale(1); }
      to{ opacity:0; transform: translate(-50%,-50%) scale(22); }
    }

    .icon{
      width: 38px;
      height: 38px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      flex: 0 0 auto;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
    }
    .icon svg{ width: 20px; height: 20px; opacity:.95; }

    .meta{ flex:1 1 auto; min-width:0; }
    .meta .name{
      display:flex;
      align-items:center;
      gap: 8px;
      font-weight: 650;
      font-size: 14px;
      line-height: 1.2;
    }
    .meta .desc{
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.3;
      margin-top: 3px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .badge{
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.82);
    }

    .rightCol{ display:grid; gap: 12px; }

    .about{
      color: rgba(255,255,255,.78);
      font-size: 14px;
      line-height: 1.55;
      margin: 0;
    }

    .chips{
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
      margin-top: 12px;
    }
    .chip{
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.10);
      padding: 8px 10px;
      font-size: 12px;
      color: rgba(255,255,255,.82);
      transition: transform .18s ease, background .18s ease;
      user-select:none;
      cursor: default;
    }
    .chip:hover{ transform: translateY(-2px); background: rgba(255,255,255,.06); }

    footer{
      padding: 12px 14px 16px;
      display:flex;
      justify-content:space-between;
      gap: 12px;
      align-items:center;
      color: rgba(255,255,255,.55);
      font-size: 12px;
      border-top: 1px solid rgba(255,255,255,.10);
    }
    footer a{ color: rgba(255,255,255,.7); text-decoration:none; }
    footer a:hover{ text-decoration:underline; }

    @media (prefers-reduced-motion: reduce){
      *{ scroll-behavior:auto !important; }
      .link, .pill, .panel, .chip{ transition: none !important; }
      .link:before{ display:none !important; }
    }

    button.link{
      width: 100%;
      text-align: left;
      cursor: pointer;
      font: inherit;
      color: inherit;
    }
    button.link::-moz-focus-inner{ border: 0; }

    /* –ú–æ–±–∏–ª—å–Ω–∞—è —à–∞–ø–∫–∞ */
    @media (max-width: 560px){
      .top{
        display: grid;
        grid-template-columns: auto 1fr;
        grid-template-areas:
          "avatar title"
          "actions actions";
        align-items: center;
        gap: 12px 14px;
      }
      .avatarDecor{ grid-area: avatar; }
      .title{ grid-area: title; min-width: 0; }
      .actions{
        grid-area: actions;
        justify-content: flex-start;
      }
      .pill{ padding: 9px 10px; font-size: 12.5px; }
    }

    /* ====== New Year: Hat (fixed, stable) ====== */
    .nyHat{ display:none; }
    body.ny .nyHat{ display:block; }

    /* –î–∞–µ–º –º–µ—Å—Ç–æ —à–∞–ø–∫–µ, —á—Ç–æ–±—ã –æ–Ω–∞ –Ω–µ –≤—ã–ª–µ–∑–∞–ª–∞ –∑–∞ –≤–µ—Ä—Ö –∫–∞—Ä—Ç–æ—á–∫–∏ (.card overflow:hidden) */
    body.ny .top{ padding-top: 34px; }

    body.ny .nyHat{
      position:absolute;
      left: -8px;
      top: -16px;
      width: 54px;
      height: 42px;
      z-index: 10;
      pointer-events:none;
      transform: rotate(-16deg);
      transform-origin: 18px 36px;
      filter: drop-shadow(0 10px 16px rgba(0,0,0,.32));
      opacity: .98;
    }

    body.ny .nyHat svg{
      width: 100%;
      height: 100%;
      display:block;
    }

    /* –ù–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ —á—É—Ç—å –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ */
    @media (max-width: 560px){
      body.ny .top{ padding-top: 32px; }
      body.ny .nyHat{
        width: 50px;
        height: 40px;
        left: -7px;
        top: -15px;
        transform: rotate(-14deg);
      }
    }

    /* –ú–∞–ª–µ–Ω—å–∫–∞—è "2026" —Ä—è–¥–æ–º —Å –Ω–∏–∫–æ–º –≤ NY —Ä–µ–∂–∏–º–µ */
    body.ny .title h1::after{
      content:" 2026";
      font-size: .72em;
      font-weight: 800;
      color: rgba(255,230,140,.80);
      text-shadow: 0 10px 30px rgba(0,0,0,.35);
    }

    /* ====== New Year: Forest (multiple trees, brighter) ====== */
    .nyForest{
      position: fixed;
      inset: 0;
      z-index: -1;         /* –º–µ–∂–¥—É canvas(-2) –∏ vignette(-1) */
      pointer-events: none; /* –∫–ª–∏–∫–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º */
      opacity: 0;
      transition: opacity .35s ease;
    }
    body.ny .nyForest{ opacity: 1; }

    .nyTree{
      position: fixed;
      bottom: -14px;
      width: min(280px, 52vw);
      opacity: 0;
      transform: translateY(12px);
      transition: opacity .35s ease, transform .35s ease, filter .25s ease;
      filter: drop-shadow(0 14px 26px rgba(0,0,0,.32));
      will-change: transform, opacity;
    }
    body.ny .nyTree{
      opacity: .82;
      transform: translateY(0);
    }

    .nyTree--right{ right: 2.2vw; }
    .nyTree--left{ left: 2.2vw; width: min(220px, 44vw); opacity: .0; }
    body.ny .nyTree--left{ opacity: .62; }
    .nyTree--center{ left: 50%; width: min(240px, 48vw); opacity: 0; transform: translate(-50%, 12px) scale(.92); }
    body.ny .nyTree--center{ opacity: .60; transform: translate(-50%, 0) scale(.92); }
    .nyTree--far{ right: 24vw; width: min(190px, 40vw); opacity: 0; transform: translateY(12px) scale(.86); }
    body.ny .nyTree--far{ opacity: .48; transform: translateY(0) scale(.86); }

    .nyTree svg{ width:100%; height:auto; display:block; }

    .nyTreeBody{
      fill: rgba(40, 170, 110, .20);
      stroke: rgba(200, 255, 220, .18);
      stroke-width: 1.2;
    }
    .nyTrunk{
      fill: rgba(120, 85, 60, .16);
      stroke: rgba(255,255,255,.10);
      stroke-width: 1.1;
    }

    .nyStar{
      fill: rgba(255, 230, 140, .26);
      stroke: rgba(255, 230, 140, .34);
      stroke-width: 1.2;
      filter: drop-shadow(0 0 16px rgba(255, 230, 140, .22));
      animation: nyTwinkle 2.4s ease-in-out infinite;
      transform-origin: 50% 50%;
    }

    .nyGarland{
      fill: none;
      stroke: rgba(255,255,255,.14);
      stroke-width: 1.4;
      stroke-linecap: round;
      opacity: .9;
      transition: opacity .2s ease, stroke .2s ease;
    }

    /* –õ–∞–º–ø–æ—á–∫–∏-–≥–∏—Ä–ª—è–Ω–¥–∞: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è (–º–µ–Ω—å—à–µ repaint) */
    .nyBulb{
      /* –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è –¥–≤—É—Ö –∞–Ω–∏–º–∞—Ü–∏–π */
      --twDelay: 0s;
      --colDelay: 0s;
      --colDur: 8.8s; /* —á—É—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ = –º–µ–Ω—å—à–µ —Å–æ–±—ã—Ç–∏–π —Å–º–µ–Ω—ã */

      /* –ë–∞–∑–æ–≤–æ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞: drop-shadow –Ω–∞ –¥–µ—Å—è—Ç–∫–∞—Ö SVG-—ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ–π.
         –ü–æ–¥—Å–≤–µ—Ç–∫–∞/—Å–≤–µ—á–µ–Ω–∏–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ hover –Ω–∞ —ë–ª–∫–µ (—Å–º. .isHover –Ω–∏–∂–µ). */
      filter: none;

      opacity: .90;
      transition: transform .18s ease, filter .18s ease, opacity .18s ease;
      transform-origin: center;

      /* twinkle —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –ø–æ opacity (–±–µ–∑ scale) ‚Äî –∑–∞–º–µ—Ç–Ω–æ –¥–µ—à–µ–≤–ª–µ */
      animation-name: nyBulbTwinkle, nyColorCycleSteps;
      animation-duration: 1.55s, var(--colDur);
      animation-timing-function: ease-in-out, linear;
      animation-iteration-count: infinite, infinite;
      animation-delay: var(--twDelay), var(--colDelay);
    }

    @keyframes nyBulbTwinkle{
      0%, 100%{ opacity: .55; }
      50%     { opacity: 1; }
    }

    /* –¶–≤–µ—Ç–æ–≤–æ–π —Ü–∏–∫–ª —Å ¬´–ø–ª–∞—Ç–æ¬ª: —Ü–≤–µ—Ç –Ω–µ –∏–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä (–º–µ–Ω—å—à–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–æ–∫) */
    @keyframes nyColorCycleSteps{
      0%, 15.9%   { fill: rgba(255,  90, 140, .92); }
      16%, 32.9%  { fill: rgba( 90, 210, 255, .92); }
      33%, 49.9%  { fill: rgba(255, 230, 140, .92); }
      50%, 65.9%  { fill: rgba(120, 255, 180, .92); }
      66%, 82.9%  { fill: rgba(160, 120, 255, .92); }
      83%, 99.9%  { fill: rgba(255, 255, 255, .92); }
      100%        { fill: rgba(255,  90, 140, .92); }
    }

    /* —Ä–∞–∑–Ω–µ—Å—ë–º –ª–∞–º–ø–æ—á–∫–∏ –ø–æ —Ñ–∞–∑–∞–º (twinkle + color), —á—Ç–æ–±—ã –ø–µ—Ä–µ–ª–∏–≤ –±—ã–ª –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π */
    .nyBulb.b1  { --twDelay: 0.00s; --colDelay: -0.20s; --colDur: 6.6s; }
    .nyBulb.b2  { --twDelay: 0.20s; --colDelay: -1.10s; --colDur: 7.0s; }
    .nyBulb.b3  { --twDelay: 0.40s; --colDelay: -2.00s; --colDur: 6.3s; }
    .nyBulb.b4  { --twDelay: 0.60s; --colDelay: -2.90s; --colDur: 7.4s; }

    .nyBulb.b5  { --twDelay: 0.10s; --colDelay: -0.65s; --colDur: 6.9s; }
    .nyBulb.b6  { --twDelay: 0.30s; --colDelay: -1.55s; --colDur: 6.4s; }
    .nyBulb.b7  { --twDelay: 0.50s; --colDelay: -2.45s; --colDur: 7.2s; }
    .nyBulb.b8  { --twDelay: 0.70s; --colDelay: -3.35s; --colDur: 6.7s; }

    .nyBulb.b9  { --twDelay: 0.15s; --colDelay: -0.95s; --colDur: 7.6s; }
    .nyBulb.b10 { --twDelay: 0.35s; --colDelay: -1.85s; --colDur: 6.2s; }
    .nyBulb.b11 { --twDelay: 0.55s; --colDelay: -2.75s; --colDur: 7.1s; }
    .nyBulb.b12 { --twDelay: 0.75s; --colDelay: -3.65s; --colDur: 6.5s; }


    @keyframes nyTwinkle{
      0%, 100%{ opacity: .55; transform: translateZ(0) scale(0.96); }
      50%     { opacity: 1;    transform: translateZ(0) scale(1.06); }
    }

    @media (prefers-reduced-motion: reduce){
      .nyBulb, .nyStar{ animation: none !important; }
    }

    /* –í Safari –∏–Ω–æ–≥–¥–∞ ¬´clip¬ª –∞–Ω–∏–º–∞—Ü–∏–π fill –≤ SVG –≤—ã–≥–ª—è–¥–∏—Ç –ª—É—á—à–µ, –µ—Å–ª–∏ –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å GPU */
    .nyBulb{ will-change: opacity, transform, filter, fill; }

    /* ====== Sound unlock toast ====== */
    .soundToast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      z-index: 50;
      max-width: min(520px, calc(100vw - 28px));
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: rgba(255,255,255,.86);
      font-size: 12.5px;
      line-height: 1.3;
      box-shadow: 0 18px 60px rgba(0,0,0,.40);
      opacity: 0;
      pointer-events: none;
      transform: translateX(-50%) translateY(8px);
      transition: opacity .25s ease, transform .25s ease;
    }
    .soundToast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    .soundToast kbd{
      font: inherit;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.14);
      color: rgba(255,255,255,.90);
      margin: 0 4px;
      white-space: nowrap;
    }
    @media (prefers-reduced-motion: reduce){
      .soundToast{ transition: none !important; }
    }
  </style>
</head>

<body>
  <canvas id="bg" aria-hidden="true"></canvas>

  <!-- –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ñ–æ–Ω: –Ω–µ—Å–∫–æ–ª—å–∫–æ —ë–ª–æ–∫ -->
  <div class="nyForest" aria-hidden="true">
    <!-- right -->
    <div class="nyTree nyTree--right">
      <svg viewBox="0 0 260 340">
        <path class="nyStar" d="M130 20l6 14 15 2-11 10 3 15-13-7-13 7 3-15-11-10 15-2 6-14z"/>
        <path class="nyTreeBody" d="M130 48 C112 70, 96 92, 84 118 C102 114, 114 114, 130 108 C146 114, 158 114, 176 118 C164 92, 148 70, 130 48 Z"/>
        <path class="nyTreeBody" d="M130 96 C104 126, 82 158, 66 202 C92 194, 110 194, 130 186 C150 194, 168 194, 194 202 C178 158, 156 126, 130 96 Z" opacity=".95"/>
        <path class="nyTreeBody" d="M130 158 C98 198, 72 244, 52 304 C90 292, 112 292, 130 282 C148 292, 170 292, 208 304 C188 244, 162 198, 130 158 Z" opacity=".92"/>
        <path class="nyTrunk" d="M114 296h32v36h-32z"/>
        <path class="nyGarland" d="M70 210 C105 190, 155 190, 190 210" />
        <path class="nyGarland" d="M82 150 C110 136, 150 136, 178 150" />
        <path class="nyGarland" d="M92 112 C112 102, 148 102, 168 112" />
        <circle class="nyBulb b1" cx="92" cy="112" r="4"/>
        <circle class="nyBulb b2" cx="112" cy="106" r="4"/>
        <circle class="nyBulb b3" cx="148" cy="106" r="4"/>
        <circle class="nyBulb b4" cx="168" cy="112" r="4"/>
        <circle class="nyBulb b5" cx="82" cy="150" r="4.2"/>
        <circle class="nyBulb b6" cx="110" cy="142" r="4.2"/>
        <circle class="nyBulb b7" cx="150" cy="142" r="4.2"/>
        <circle class="nyBulb b8" cx="178" cy="150" r="4.2"/>
        <circle class="nyBulb b9"  cx="70"  cy="210" r="4.6"/>
        <circle class="nyBulb b10" cx="105" cy="198" r="4.6"/>
        <circle class="nyBulb b11" cx="155" cy="198" r="4.6"/>
        <circle class="nyBulb b12" cx="190" cy="210" r="4.6"/>
      </svg>
    </div>

    <!-- left -->
    <div class="nyTree nyTree--left">
      <svg viewBox="0 0 260 340">
        <path class="nyStar" d="M130 20l6 14 15 2-11 10 3 15-13-7-13 7 3-15-11-10 15-2 6-14z"/>
        <path class="nyTreeBody" d="M130 48 C112 70, 96 92, 84 118 C102 114, 114 114, 130 108 C146 114, 158 114, 176 118 C164 92, 148 70, 130 48 Z"/>
        <path class="nyTreeBody" d="M130 96 C104 126, 82 158, 66 202 C92 194, 110 194, 130 186 C150 194, 168 194, 194 202 C178 158, 156 126, 130 96 Z" opacity=".95"/>
        <path class="nyTreeBody" d="M130 158 C98 198, 72 244, 52 304 C90 292, 112 292, 130 282 C148 292, 170 292, 208 304 C188 244, 162 198, 130 158 Z" opacity=".92"/>
        <path class="nyTrunk" d="M114 296h32v36h-32z"/>
        <path class="nyGarland" d="M70 210 C105 190, 155 190, 190 210" />
        <path class="nyGarland" d="M82 150 C110 136, 150 136, 178 150" />
        <path class="nyGarland" d="M92 112 C112 102, 148 102, 168 112" />
        <circle class="nyBulb b1" cx="92" cy="112" r="4"/>
        <circle class="nyBulb b2" cx="112" cy="106" r="4"/>
        <circle class="nyBulb b3" cx="148" cy="106" r="4"/>
        <circle class="nyBulb b4" cx="168" cy="112" r="4"/>
        <circle class="nyBulb b5" cx="82" cy="150" r="4.2"/>
        <circle class="nyBulb b6" cx="110" cy="142" r="4.2"/>
        <circle class="nyBulb b7" cx="150" cy="142" r="4.2"/>
        <circle class="nyBulb b8" cx="178" cy="150" r="4.2"/>
        <circle class="nyBulb b9"  cx="70"  cy="210" r="4.6"/>
        <circle class="nyBulb b10" cx="105" cy="198" r="4.6"/>
        <circle class="nyBulb b11" cx="155" cy="198" r="4.6"/>
        <circle class="nyBulb b12" cx="190" cy="210" r="4.6"/>
      </svg>
    </div>

    <!-- center -->
    <div class="nyTree nyTree--center">
      <svg viewBox="0 0 260 340">
        <path class="nyStar" d="M130 20l6 14 15 2-11 10 3 15-13-7-13 7 3-15-11-10 15-2 6-14z"/>
        <path class="nyTreeBody" d="M130 48 C112 70, 96 92, 84 118 C102 114, 114 114, 130 108 C146 114, 158 114, 176 118 C164 92, 148 70, 130 48 Z"/>
        <path class="nyTreeBody" d="M130 96 C104 126, 82 158, 66 202 C92 194, 110 194, 130 186 C150 194, 168 194, 194 202 C178 158, 156 126, 130 96 Z" opacity=".95"/>
        <path class="nyTreeBody" d="M130 158 C98 198, 72 244, 52 304 C90 292, 112 292, 130 282 C148 292, 170 292, 208 304 C188 244, 162 198, 130 158 Z" opacity=".92"/>
        <path class="nyTrunk" d="M114 296h32v36h-32z"/>
        <path class="nyGarland" d="M70 210 C105 190, 155 190, 190 210" />
        <path class="nyGarland" d="M82 150 C110 136, 150 136, 178 150" />
        <path class="nyGarland" d="M92 112 C112 102, 148 102, 168 112" />
        <circle class="nyBulb b1" cx="92" cy="112" r="4"/>
        <circle class="nyBulb b2" cx="112" cy="106" r="4"/>
        <circle class="nyBulb b3" cx="148" cy="106" r="4"/>
        <circle class="nyBulb b4" cx="168" cy="112" r="4"/>
        <circle class="nyBulb b5" cx="82" cy="150" r="4.2"/>
        <circle class="nyBulb b6" cx="110" cy="142" r="4.2"/>
        <circle class="nyBulb b7" cx="150" cy="142" r="4.2"/>
        <circle class="nyBulb b8" cx="178" cy="150" r="4.2"/>
        <circle class="nyBulb b9"  cx="70"  cy="210" r="4.6"/>
        <circle class="nyBulb b10" cx="105" cy="198" r="4.6"/>
        <circle class="nyBulb b11" cx="155" cy="198" r="4.6"/>
        <circle class="nyBulb b12" cx="190" cy="210" r="4.6"/>
      </svg>
    </div>

    <!-- far (small) -->
    <div class="nyTree nyTree--far">
      <svg viewBox="0 0 260 340">
        <path class="nyStar" d="M130 20l6 14 15 2-11 10 3 15-13-7-13 7 3-15-11-10 15-2 6-14z"/>
        <path class="nyTreeBody" d="M130 48 C112 70, 96 92, 84 118 C102 114, 114 114, 130 108 C146 114, 158 114, 176 118 C164 92, 148 70, 130 48 Z"/>
        <path class="nyTreeBody" d="M130 96 C104 126, 82 158, 66 202 C92 194, 110 194, 130 186 C150 194, 168 194, 194 202 C178 158, 156 126, 130 96 Z" opacity=".95"/>
        <path class="nyTreeBody" d="M130 158 C98 198, 72 244, 52 304 C90 292, 112 292, 130 282 C148 292, 170 292, 208 304 C188 244, 162 198, 130 158 Z" opacity=".92"/>
        <path class="nyTrunk" d="M114 296h32v36h-32z"/>
        <path class="nyGarland" d="M70 210 C105 190, 155 190, 190 210" />
        <path class="nyGarland" d="M82 150 C110 136, 150 136, 178 150" />
        <path class="nyGarland" d="M92 112 C112 102, 148 102, 168 112" />
        <circle class="nyBulb b1" cx="92" cy="112" r="4"/>
        <circle class="nyBulb b2" cx="112" cy="106" r="4"/>
        <circle class="nyBulb b3" cx="148" cy="106" r="4"/>
        <circle class="nyBulb b4" cx="168" cy="112" r="4"/>
        <circle class="nyBulb b5" cx="82" cy="150" r="4.2"/>
        <circle class="nyBulb b6" cx="110" cy="142" r="4.2"/>
        <circle class="nyBulb b7" cx="150" cy="142" r="4.2"/>
        <circle class="nyBulb b8" cx="178" cy="150" r="4.2"/>
        <circle class="nyBulb b9"  cx="70"  cy="210" r="4.6"/>
        <circle class="nyBulb b10" cx="105" cy="198" r="4.6"/>
        <circle class="nyBulb b11" cx="155" cy="198" r="4.6"/>
        <circle class="nyBulb b12" cx="190" cy="210" r="4.6"/>
      </svg>
    </div>
  </div>

  <div class="vignette" aria-hidden="true"></div>

  <div class="wrap">
    <main class="card">
      <header class="top">
        <div class="avatarDecor">
          <div class="nyHat" aria-hidden="true">
            <svg viewBox="0 0 120 90" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <defs>
                <linearGradient id="capGrad" x1="18" y1="10" x2="105" y2="70" gradientUnits="userSpaceOnUse">
                  <stop offset="0" stop-color="#BDA7FF"/>
                  <stop offset="0.45" stop-color="#8F6BFF"/>
                  <stop offset="1" stop-color="#5B2BFF"/>
                </linearGradient>

                <linearGradient id="brimGrad" x1="14" y1="52" x2="110" y2="80" gradientUnits="userSpaceOnUse">
                  <stop offset="0" stop-color="rgba(255,255,255,0.96)"/>
                  <stop offset="1" stop-color="rgba(210,200,255,0.75)"/>
                </linearGradient>

                <radialGradient id="pomGrad" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse"
                  gradientTransform="translate(98 18) rotate(90) scale(14)">
                  <stop offset="0" stop-color="rgba(255,255,255,0.98)"/>
                  <stop offset="0.55" stop-color="rgba(225,215,255,0.92)"/>
                  <stop offset="1" stop-color="rgba(150,120,255,0.35)"/>
                </radialGradient>
              </defs>

              <!-- –ø–æ–º–ø–æ–Ω -->
              <circle cx="98" cy="18" r="12" fill="url(#pomGrad)"/>
              <circle cx="94" cy="14" r="3.8" fill="rgba(255,255,255,0.55)"/>

              <!-- —Ñ–∏–æ–ª–µ—Ç–æ–≤–∞—è ‚Äú—Ç–∫–∞–Ω—å‚Äù -->
              <path d="M24 56
                      C18 34, 32 18, 55 12
                      C78 6, 96 18, 102 36
                      C106 48, 99 59, 86 60
                      C65 61, 44 60, 24 56 Z"
                    fill="url(#capGrad)"
                    stroke="rgba(255,255,255,0.16)"
                    stroke-width="2"/>

              <!-- –ª—ë–≥–∫–∏–π –±–ª–∏–∫ -->
              <path d="M34 52
                      C32 40, 40 27, 56 23
                      C70 20, 82 25, 88 34"
                    stroke="rgba(255,255,255,0.22)"
                    stroke-width="6"
                    stroke-linecap="round"
                    opacity="0.28"/>

              <!-- –±–µ–ª–∞—è –∫—Ä–æ–º–∫–∞ -->
              <rect x="14" y="52" width="96" height="24" rx="12"
                    fill="url(#brimGrad)"
                    stroke="rgba(255,255,255,0.18)"
                    stroke-width="2"/>
            </svg>
          </div>
          <div class="avatar" aria-label="–ê–≤–∞—Ç–∞—Ä">
            <img src="avatar.jpg" alt="–ú–æ–π –∞–≤–∞—Ç–∞—Ä" decoding="async" onerror="this.remove(); this.parentElement.insertAdjacentHTML('beforeend','<span>PP</span>');" />
          </div>
        </div>

        <div class="title">
          <h1>Pifpafpifpaf</h1>
          <p class="subtitle"></p>
        </div>

        <div class="actions">
          <button class="pill" id="bgToggle" type="button" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ñ–æ–Ω">
            –§–æ–Ω: <span id="bgModeLabel">–°–Ω–µ–≥</span>
          </button>
          <button class="pill" id="soundToggle" type="button" title="–í–∫–ª—é—á–∏—Ç—å –∏–ª–∏ –≤—ã–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫–∏">
            –ó–≤—É–∫: <span id="soundLabel">–í—ã–∫–ª</span>
          </button>
          <button class="pill" id="nyToggle" type="button" title="–ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ä–µ–∂–∏–º">
            –ù–æ–≤—ã–π –≥–æ–¥: <span id="nyLabel">–í—ã–∫–ª</span>
          </button>
        </div>
      </header>

      <section class="grid">
        <section class="panel" data-tilt>
          <h2>–°–≤—è–∑—å –∏ –∏–≥—Ä—ã</h2>
          <div class="links">
            <a class="link" href="https://t.me/username" target="_blank" rel="noreferrer">
              <span class="icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M21 5.2 3.7 11.9c-1.2.5-1.2 1.2-.2 1.5l4.6 1.4 1.8 5.5c.2.6.1.8.8.8.6 0 .9-.3 1.2-.6l2.2-2.2 4.5 3.3c.8.4 1.4.2 1.6-.8l3-14.2c.3-1.2-.4-1.7-1.2-1.4Z" stroke="rgba(255,255,255,.85)" stroke-width="1.2"/>
                </svg>
              </span>
              <span class="meta">
                <span class="name">Telegram <span class="badge">@pifpafpifpaf</span></span>
                <span class="desc">–ù–∞–ø–∏—Å–∞—Ç—å –º–Ω–µ</span>
              </span>
              <span class="badge">link</span>
            </a>

            <a class="link" href="https://steamcommunity.com/id/Pifpafpifpaf1337/" target="_blank" rel="noreferrer">
              <span class="icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M8.2 10.5h7.6c1.8 0 3.2 1.4 3.2 3.2 0 .8-.3 1.5-.7 2.1l-1 1.3a2.2 2.2 0 0 1-3.6-.2l-1.1-1.5a.8.8 0 0 0-1.2 0l-1.1 1.5a2.2 2.2 0 0 1-3.6.2l-1-1.3A3.2 3.2 0 0 1 5 13.7c0-1.8 1.4-3.2 3.2-3.2Z"
                        stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linejoin="round"/>
                  <path d="M9 13h-2" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round"/>
                  <path d="M8 12v2" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round"/>
                  <path d="M16.5 12.7h.1" stroke="rgba(255,255,255,.85)" stroke-width="2.6" stroke-linecap="round"/>
                  <path d="M18 14.2h.1" stroke="rgba(255,255,255,.85)" stroke-width="2.6" stroke-linecap="round"/>
                </svg>
              </span>
              <span class="meta">
                <span class="name">Steam <span class="badge">–ø—Ä–æ—Ñ–∏–ª—å</span></span>
                <span class="desc">–°—Ç–∏–º –ª–µ–≥–µ–Ω–¥—ã</span>
              </span>
              <span class="badge">link</span>
            </a>

            <a class="link" href="https://tracker.gg/valorant/profile/riot/Pifpafpifpaf%23lolz" target="_blank" rel="noreferrer">
              <span class="icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M12 3v4" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round"/>
                  <path d="M12 17v4" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round"/>
                  <path d="M3 12h4" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round"/>
                  <path d="M17 12h4" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round"/>
                  <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" stroke="rgba(255,255,255,.85)" stroke-width="1.2"/>
                </svg>
              </span>
              <span class="meta">
                <span class="name">Valorant Tracker</span>
                <span class="desc">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–∞—Ç—á–∏</span>
              </span>
              <span class="badge">link</span>
            </a>

            <button class="link" type="button" data-copy-text="pifpafpifpaf">
              <span class="icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M7.5 7.5h9A3.5 3.5 0 0 1 20 11v4A3.5 3.5 0 0 1 16.5 18H12l-3.5 2v-2H7.5A3.5 3.5 0 0 1 4 15v-4A3.5 3.5 0 0 1 7.5 7.5Z"
                        stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linejoin="round"/>
                  <path d="M9 12h6" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round"/>
                </svg>
              </span>
              <span class="meta">
                <span class="name">Discord <span class="badge">pifpafpifpaf</span></span>
                <span class="desc">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∏–∫</span>
              </span>
              <span class="badge copyBadge">copy</span>
            </button>

            <a class="link" href="https://www.twitch.tv/pifpafpifpaf" target="_blank" rel="noreferrer">
              <span class="icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M9 8.5v7l7-3.5-7-3.5Z" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linejoin="round"/>
                  <path d="M6.5 6.5h11A2 2 0 0 1 19.5 8.5v7A2 2 0 0 1 17.5 17.5h-4l-2 2-2-2h-3A2 2 0 0 1 4.5 15.5v-7A2 2 0 0 1 6.5 6.5Z"
                        stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linejoin="round"/>
                </svg>
              </span>
              <span class="meta">
                <span class="name">Twitch</span>
                <span class="desc">–ú–æ–∂–µ—Ç –∫–æ–≥–¥–∞-—Ç–æ –ø–æ—Å—Ç—Ä–∏–º–ª—é</span>
              </span>
              <span class="badge">link</span>
            </a>
          </div>
        </section>

        <aside class="rightCol">
          <section class="panel" data-tilt>
            <h2>–û–±–æ –º–Ω–µ</h2>
            <p class="about">–ü—Ä–∏–≤–µ—Ç! –ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã –≤–∞–∂–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è —Å–≤—è–∑–∏, –∏–≥—Ä –∏ –º—É–∑—ã–∫–∏.</p>
            <div class="chips" aria-label="–¢–µ–≥–∏">
              <span class="chip">üéß –ú—É–∑—ã–∫–∞</span>
              <span class="chip">üéÆ –ò–≥—Ä—ã</span>
              <span class="chip">üí¨ –°–≤—è–∑—å</span>
              <span class="chip">‚ú® –°—Å—ã–ª–∫–∏</span>
            </div>
          </section>

          <section class="panel" data-tilt>
            <h2>–ú—É–∑—ã–∫–∞ –∏ –ø—Ä–æ—á–µ–µ</h2>
            <div class="links">
              <a class="link" href="https://open.spotify.com/user/9nxyvi6nqz9k7n1egby0x9it1" target="_blank" rel="noreferrer">
                <span class="icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none">
                    <path d="M10 18a2.5 2.5 0 1 1-1.5-2.3V7.5L19 5v8.5" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M19 16.5a2.5 2.5 0 1 1-1.5-2.3V5" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
                <span class="meta">
                  <span class="name">Spotify <span class="badge">–ø–ª–µ–π–ª–∏—Å—Ç</span></span>
                  <span class="desc">–ú–æ—è –º—É–∑—ã–∫–∞</span>
                </span>
                <span class="badge">link</span>
              </a>

              <a class="link" href="https://lolz.guru/members/186163" target="_blank" rel="noreferrer">
                <span class="icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none">
                    <path d="M7.5 7.5h9A3.5 3.5 0 0 1 20 11v4A3.5 3.5 0 0 1 16.5 18H12l-3.5 2v-2H7.5A3.5 3.5 0 0 1 4 15v-4A3.5 3.5 0 0 1 7.5 7.5Z"
                          stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linejoin="round"/>
                    <path d="M8.8 11.2h6.4" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round"/>
                    <path d="M8.8 13.8h4.6" stroke="rgba(255,255,255,.85)" stroke-width="1.2" stroke-linecap="round"/>
                  </svg>
                </span>
                <span class="meta">
                  <span class="name">Lolz</span>
                  <span class="desc">–ü—Ä–æ—Ñ–∏–ª—å –Ω–∞ –ª–æ–ª–∑–µ</span>
                </span>
                <span class="badge">link</span>
              </a>
            </div>
          </section>
        </aside>
      </section>

      <footer>
        <span>¬© <span id="year"></span> Pifpafpifpaf</span>
        <a href="#" id="toTop"></a>
      </footer>
    </main>
  </div>

  <div id="soundToast" class="soundToast" role="status" aria-live="polite">
    –ó–≤—É–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –±—Ä–∞—É–∑–µ—Ä–æ–º. –ù–∞–∂–º–∏ <kbd>–∫–ª–∏–∫</kbd> –∏–ª–∏ <kbd>Enter</kbd>, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å.
  </div>

  <script>
    // ====== Copy helper for Discord ======
    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      } catch {
        try{
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          ta.style.top = '-9999px';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          const ok = document.execCommand('copy');
          ta.remove();
          return ok;
        } catch {
          return false;
        }
      }
    }

    document.addEventListener('click', async (e) => {
      const el = e.target.closest('[data-copy-text]');
      if(!el) return;

      e.preventDefault();

      const text = el.getAttribute('data-copy-text') || '';
      const ok = await copyText(text);

      const badge = el.querySelector('.copyBadge');
      if(badge){
        const old = badge.textContent;
        badge.textContent = ok ? 'copied' : 'failed';
        setTimeout(() => badge.textContent = old, 1100);
      }
    });

    // ====== Basics ======
    document.getElementById('year').textContent = String(new Date().getFullYear());

    document.getElementById('toTop').addEventListener('click', (e) => {
      e.preventDefault();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Ripple on click for links & pills
    function addRipple(el, clientX, clientY){
      const r = document.createElement('span');
      r.className = 'ripple';
      const rect = el.getBoundingClientRect();
      r.style.left = (clientX - rect.left) + 'px';
      r.style.top  = (clientY - rect.top) + 'px';
      el.appendChild(r);
      r.addEventListener('animationend', () => r.remove(), { once: true });
    }
    document.addEventListener('click', (e) => {
      const target = e.target.closest('.link, .pill');
      if(!target) return;
      addRipple(target, e.clientX, e.clientY);
    });

    // ====== Interaction sounds (WebAudio) ======
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    const soundToggle = document.getElementById('soundToggle');
    const soundLabel = document.getElementById('soundLabel');

    const sound = {
      // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–≤—É–∫ –≤—ã–∫–ª—é—á–µ–Ω (–≤–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∫–Ω–æ–ø–∫–æ–π)
      enabled: false,
      ctx: null,
      master: null,
      lastHoverAt: 0,
      lastFireworkAt: 0,
      noiseBuf: null
    };

    // –ó–≤—É–∫ –≤—Å–µ–≥–¥–∞ —Å—Ç–∞—Ä—Ç—É–µ—Ç –≤—ã–∫–ª—é—á–µ–Ω–Ω—ã–º (–≤ —Ç–æ–º —á–∏—Å–ª–µ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
    sound.enabled = false;
    // –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π —á–∏—Å—Ç–∏–º —Å—Ç–∞—Ä–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ "–í–∫–ª" –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    try{ localStorage.removeItem('soundEnabled'); } catch {}

    function syncSoundUI(){
      soundLabel.textContent = sound.enabled ? "–í–∫–ª" : "–í—ã–∫–ª";
    }
    syncSoundUI();

    // ====== Autoplay policy helper (best-effort) ======
    const soundToast = document.getElementById('soundToast');
    let unlockListenersInstalled = false;

    function setSoundToast(show){
      if(!soundToast) return;
      soundToast.classList.toggle('show', !!show);
    }

    function pokeSilent(){
      // –ù–∞ iOS/Safari –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ ¬´–ø—Ä–æ–∏–≥—Ä–∞—Ç—å¬ª —á—Ç–æ-—Ç–æ –Ω—É–ª–µ–≤–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏, —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ–∂–∏–ª.
      if(!sound.ctx) return;
      try{
        const ctx = sound.ctx;
        const osc = ctx.createOscillator();
        const g = ctx.createGain();
        g.gain.value = 0;
        osc.frequency.value = 30;
        osc.connect(g);
        g.connect(ctx.destination);
        osc.start();
        osc.stop(ctx.currentTime + 0.02);
      } catch {}
    }

    async function unlockAudio(){
      if(!sound.enabled) { setSoundToast(false); return false; }
      if(!ensureAudio()) { setSoundToast(false); return false; }

      try{ await sound.ctx.resume(); } catch {}
      pokeSilent();

      const ok = !!sound.ctx && sound.ctx.state === 'running';
      setSoundToast(sound.enabled && !ok);
      return ok;
    }

    function installUnlockListeners(){
      if(unlockListenersInstalled) return;
      unlockListenersInstalled = true;

      const handler = () => { unlockAudio(); };

      // –≠—Ç–∏ —Å–æ–±—ã—Ç–∏—è –æ–±—ã—á–Ω–æ —Å—á–∏—Ç–∞—é—Ç—Å—è ¬´user gesture¬ª.
      window.addEventListener('pointerdown', handler, { once: true, passive: true });
      window.addEventListener('touchstart', handler, { once: true, passive: true });
      window.addEventListener('keydown', handler, { once: true });
    }

    function tryAutoUnlockAudio(){
      // –ü–æ–ø—ã—Ç–∫–∞ –≤–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫ ¬´—Å—Ä–∞–∑—É¬ª –ø—Ä–∏ –∑–∞—Ö–æ–¥–µ. –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–ª–∏—Ç–∏–∫–æ–π autoplay.
      if(!sound.enabled) { setSoundToast(false); return; }
      if(!ensureAudio()) { setSoundToast(false); return; }

      sound.ctx.resume().catch(() => {});
      setTimeout(() => {
        const ok = !!sound.ctx && sound.ctx.state === 'running';
        setSoundToast(sound.enabled && !ok);
        if(!ok) installUnlockListeners();
      }, 120);
    }

    // –ù–µ –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –∑–≤—É–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–≤—É–∫ –≤—ã–∫–ª—é—á–µ–Ω).

    function ensureAudio(){
      if(!sound.enabled) return false;
      const AC = window.AudioContext || window.webkitAudioContext;
      if(!AC) return false;

      if(!sound.ctx){
        sound.ctx = new AC();
        sound.master = sound.ctx.createGain();
        sound.master.gain.value = 0.14;
        sound.master.connect(sound.ctx.destination);
      }
      if(sound.ctx.state === 'suspended'){
        sound.ctx.resume().catch(() => {});
      }
      return true;
    }

    function playHoverSound(){
      if(!ensureAudio()) return;

      const now = performance.now();
      if(now - sound.lastHoverAt < 70) return;
      sound.lastHoverAt = now;

      const ctx = sound.ctx;
      const t0 = ctx.currentTime;

      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      const filter = ctx.createBiquadFilter();

      osc.type = 'sine';
      osc.frequency.setValueAtTime(720, t0);
      osc.frequency.exponentialRampToValueAtTime(520, t0 + 0.03);

      filter.type = 'highpass';
      filter.frequency.setValueAtTime(200, t0);

      gain.gain.setValueAtTime(0.0001, t0);
      gain.gain.exponentialRampToValueAtTime(0.30, t0 + 0.008);
      gain.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.06);

      osc.connect(filter);
      filter.connect(gain);
      gain.connect(sound.master);

      osc.start(t0);
      osc.stop(t0 + 0.07);
    }

    function playClickSound(){
      if(!ensureAudio()) return;

      const ctx = sound.ctx;
      const t0 = ctx.currentTime;

      const osc1 = ctx.createOscillator();
      const osc2 = ctx.createOscillator();
      const gain = ctx.createGain();
      const filter = ctx.createBiquadFilter();

      osc1.type = 'triangle';
      osc2.type = 'sine';

      const f = 190 + Math.random() * 50;
      osc1.frequency.setValueAtTime(f, t0);
      osc1.frequency.exponentialRampToValueAtTime(f * 0.72, t0 + 0.06);

      osc2.frequency.setValueAtTime(f * 2.1, t0);
      osc2.frequency.exponentialRampToValueAtTime(f * 1.4, t0 + 0.05);

      filter.type = 'lowpass';
      filter.frequency.setValueAtTime(1600, t0);
      filter.frequency.exponentialRampToValueAtTime(700, t0 + 0.06);

      gain.gain.setValueAtTime(0.0001, t0);
      gain.gain.exponentialRampToValueAtTime(0.55, t0 + 0.004);
      gain.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.09);

      osc1.connect(filter);
      osc2.connect(filter);
      filter.connect(gain);
      gain.connect(sound.master);

      osc1.start(t0);
      osc2.start(t0);
      osc1.stop(t0 + 0.10);
      osc2.stop(t0 + 0.10);
    }

    // ====== Firework "pop" (quiet, atmospheric) ======
    function ensureNoiseBuffer(){
      if(!sound.ctx) return null;
      if(sound.noiseBuf) return sound.noiseBuf;

      const ctx = sound.ctx;
      const seconds = 0.22;
      const buffer = ctx.createBuffer(1, Math.floor(ctx.sampleRate * seconds), ctx.sampleRate);
      const data = buffer.getChannelData(0);
      for(let i = 0; i < data.length; i++){
        // –º—è–≥–∫–∏–π –±–µ–ª—ã–π —à—É–º
        data[i] = (Math.random() * 2 - 1) * 0.85;
      }
      sound.noiseBuf = buffer;
      return buffer;
    }

    function playFireworkPop(xNorm = 0.5){
      // xNorm: 0..1 (–ø–æ–∑–∏—Ü–∏—è –ø–æ —ç–∫—Ä–∞–Ω—É)
      if(!ensureAudio()) return;

      const nowMs = performance.now();
      // —á—Ç–æ–±—ã 10 –∑–∞–ª–ø–æ–≤ –ø–æ–¥—Ä—è–¥ –Ω–µ –ø—Ä–µ–≤—Ä–∞—â–∞–ª–∏—Å—å –≤ –∫–∞—à—É
      if(nowMs - sound.lastFireworkAt < 75) return;
      sound.lastFireworkAt = nowMs;

      const ctx = sound.ctx;
      const t0 = ctx.currentTime;

      // –æ–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å ¬´–ø—É–ø–∞¬ª (–æ—á–µ–Ω—å —Ç–∏—Ö–æ)
      const out = ctx.createGain();
      out.gain.setValueAtTime(0.0001, t0);
      out.gain.exponentialRampToValueAtTime(0.12, t0 + 0.004);
      out.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.16);

      // –ª—ë–≥–∫–æ–µ –ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–µ
      const pan = (xNorm - 0.5) * 0.55;
      const panner = (typeof ctx.createStereoPanner === 'function') ? ctx.createStereoPanner() : null;
      if(panner) panner.pan.setValueAtTime(pan, t0);

      // –º—è–≥–∫–∏–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä, —á—Ç–æ–±—ã –Ω–µ –≤—ã–ø–∏—Ä–∞–ª–æ
      const comp = ctx.createDynamicsCompressor();
      comp.threshold.setValueAtTime(-28, t0);
      comp.knee.setValueAtTime(18, t0);
      comp.ratio.setValueAtTime(3.0, t0);
      comp.attack.setValueAtTime(0.003, t0);
      comp.release.setValueAtTime(0.08, t0);

      // –æ—Å–Ω–æ–≤–Ω–∞—è ¬´–ø—É–ø¬ª-—Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
      const tone1 = ctx.createOscillator();
      const tone2 = ctx.createOscillator();
      const tGain = ctx.createGain();

      tone1.type = 'sine';
      tone2.type = 'triangle';

      const base = 160 + Math.random() * 40;
      tone1.frequency.setValueAtTime(base * 2.2, t0);
      tone1.frequency.exponentialRampToValueAtTime(base * 1.2, t0 + 0.05);

      tone2.frequency.setValueAtTime(base * 1.2, t0);
      tone2.frequency.exponentialRampToValueAtTime(base * 0.72, t0 + 0.08);

      tGain.gain.setValueAtTime(0.0001, t0);
      tGain.gain.exponentialRampToValueAtTime(0.85, t0 + 0.003);
      tGain.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.10);

      // –Ω–µ–±–æ–ª—å—à–æ–π "–≤–æ–∑–¥—É—Ö" ‚Äî —à—É–º —á–µ—Ä–µ–∑ bandpass
      const noiseBuf = ensureNoiseBuffer();
      const noise = ctx.createBufferSource();
      noise.buffer = noiseBuf;

      const nFilter = ctx.createBiquadFilter();
      nFilter.type = 'bandpass';
      nFilter.frequency.setValueAtTime(2100 + Math.random() * 500, t0);
      nFilter.Q.setValueAtTime(1.6, t0);

      const nGain = ctx.createGain();
      nGain.gain.setValueAtTime(0.0001, t0);
      nGain.gain.exponentialRampToValueAtTime(0.45, t0 + 0.002);
      nGain.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.07);

      // Wiring
      tone1.connect(tGain);
      tone2.connect(tGain);
      tGain.connect(out);

      noise.connect(nFilter);
      nFilter.connect(nGain);
      nGain.connect(out);

      if(panner){
        out.connect(panner);
        panner.connect(comp);
      } else {
        out.connect(comp);
      }
      comp.connect(sound.master);

      // Play
      tone1.start(t0);
      tone2.start(t0);
      noise.start(t0);

      tone1.stop(t0 + 0.14);
      tone2.stop(t0 + 0.14);
      noise.stop(t0 + 0.08);
    }

    soundToggle.addEventListener('click', async () => {
      sound.enabled = !sound.enabled;
      // –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–≤—É–∫ —Å–Ω–æ–≤–∞ –±—É–¥–µ—Ç –≤—ã–∫–ª—é—á–µ–Ω
      syncSoundUI();

      if(sound.enabled){
        // –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ ‚Äî —ç—Ç–æ –∂–µ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞—É–¥–∏–æ
        const ok = await unlockAudio();
        if(!ok) installUnlockListeners();
        playClickSound();
      } else {
        setSoundToast(false);
      }
    });

    document.addEventListener('pointerover', (e) => {
      const el = e.target.closest('.link, .pill, .chip');
      if(!el) return;
      if(prefersReduced) return;
      playHoverSound();
    }, { passive: true });

    document.addEventListener('pointerdown', (e) => {
      const el = e.target.closest('.link, .pill');
      if(!el) return;
      playClickSound();
    }, { passive: true });

    // ====== Tilt effect ======
    function attachTilt(el){
      if (prefersReduced) return;

      const maxTilt = 10;
      const maxLift = 6;

      function onMove(e){
        const rect = el.getBoundingClientRect();
        const px = (e.clientX - rect.left) / rect.width;
        const py = (e.clientY - rect.top) / rect.height;
        const rx = (py - 0.5) * -2 * maxTilt;
        const ry = (px - 0.5) *  2 * maxTilt;
        el.style.transform = `translateY(-${maxLift}px) rotateX(${rx.toFixed(2)}deg) rotateY(${ry.toFixed(2)}deg)`;
      }
      function onLeave(){ el.style.transform = ''; }

      el.addEventListener('mousemove', onMove);
      el.addEventListener('mouseleave', onLeave);
    }
    document.querySelectorAll('[data-tilt]').forEach(attachTilt);

    // ====== Canvas setup ======
    const canvas = document.getElementById('bg');
    const ctx = canvas.getContext('2d', { alpha: true });

    let W = 0, H = 0, DPR = 1;
    function resize(){
      DPR = Math.min(window.devicePixelRatio || 1, 2);
      W = Math.floor(window.innerWidth);
      H = Math.floor(window.innerHeight);
      canvas.width = Math.floor(W * DPR);
      canvas.height = Math.floor(H * DPR);
      canvas.style.width = W + "px";
      canvas.style.height = H + "px";
      ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
    }
    window.addEventListener('resize', resize, { passive: true });
    resize();

    function rand(min, max){ return Math.random() * (max - min) + min; }
    function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }
    function lerp(a, b, t){ return a + (b - a) * t; }

    // ====== Background: Snow / Stars ======
    const modes = {
      snow:  { label: "–°–Ω–µ–≥",  count: 140 },
      stars: { label: "–ó–≤—ë–∑–¥—ã", count: 180 },
    };
    let mode = 'snow';

    const bgModeLabel = document.getElementById('bgModeLabel');
    const bgToggle = document.getElementById('bgToggle');

    let particles = [];

    function makeParticle(){
      if(mode === 'snow'){
        return {
          x: rand(0, W),
          y: rand(0, H),
          r: rand(1.1, 3.2),
          vx: rand(-0.25, 0.25),
          vy: rand(0.6, 1.6),
          wobble: rand(0, Math.PI * 2),
          wobbleSpeed: rand(0.008, 0.02),
          alpha: rand(0.25, 0.75),
        };
      }
      return {
        x: rand(0, W),
        y: rand(0, H),
        r: rand(0.7, 1.9),
        vx: rand(-0.08, 0.08),
        vy: rand(-0.05, 0.12),
        tw: rand(0, Math.PI * 2),
        twSpeed: rand(0.008, 0.02),
        alpha: rand(0.25, 0.85),
      };
    }

    function rebuild(){
      const n = modes[mode].count;
      particles = Array.from({ length: n }, () => makeParticle());
      bgModeLabel.textContent = modes[mode].label;
    }

    bgToggle.addEventListener('click', () => {
      mode = (mode === 'snow') ? 'stars' : 'snow';
      rebuild();
    });

    rebuild();

    // ====== New Year mode toggle ======
    const nyToggle = document.getElementById('nyToggle');
    const nyLabel = document.getElementById('nyLabel');


    function isNYSeason(){
      const d = new Date();
      const m = d.getMonth(); // 0..11
      const day = d.getDate();
      return (m === 11 && day >= 15) || (m === 0 && day <= 10);
    }

    // ====== Mini fireworks (NY) - MORE & COLORFUL ======
    const fw = [];
    const fwFlash = [];

    const FW_PALETTE = [
      { r: 160, g: 120, b: 255 }, // purple
      { r: 255, g:  90, b: 140 }, // pink/red
      { r: 255, g: 230, b: 140 }, // gold
      { r: 120, g: 255, b: 180 }, // green
      { r:  90, g: 210, b: 255 }, // cyan
      { r: 255, g: 255, b: 255 }, // white
    ];

    function spawnFireworkBurst(x, y, count = 92){
      const now = performance.now();
      fwFlash.push({ x, y, t: now, life: 220 });

      // —Ç–∏—Ö–∏–π "–ø—É–ø" –ø–æ–¥ –≤–∑—Ä—ã–≤ (–µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω –∑–≤—É–∫)
      playFireworkPop(clamp(x / Math.max(1, W), 0, 1));

      for(let i = 0; i < count; i++){
        const ang = rand(0, Math.PI * 2);
        const sp  = rand(2.2, 7.6);
        const c = FW_PALETTE[(Math.random() * FW_PALETTE.length) | 0];

        fw.push({
          x, y,
          vx: Math.cos(ang) * sp,
          vy: Math.sin(ang) * sp,
          t: now,
          life: rand(720, 1300),
          r: rand(1.2, 2.6),
          a: rand(0.70, 1.00),
          cr: c.r, cg: c.g, cb: c.b
        });
      }
    }

    function triggerNYFireworks(){
      if(prefersReduced) return;

      const bursts = 10; // –±–æ–ª—å—à–µ –∑–∞–ª–ø–æ–≤
      for(let i = 0; i < bursts; i++){
        const delay = i * 170 + rand(0, 120);
        setTimeout(() => {
          spawnFireworkBurst(
            rand(W * 0.16, W * 0.84),
            rand(H * 0.10, H * 0.52),
            90 + ((Math.random() * 34) | 0)
          );
        }, delay);
      }
    }

    function updateAndDrawFireworks(now, dt){
      if(fwFlash.length){
        ctx.save();
        ctx.globalCompositeOperation = 'lighter';
        for(let i = fwFlash.length - 1; i >= 0; i--){
          const f = fwFlash[i];
          const age = now - f.t;
          const k = 1 - Math.min(1, age / f.life);
          if(k <= 0){ fwFlash.splice(i, 1); continue; }

          const rad = 70 + (1 - k) * 90;
          const g = ctx.createRadialGradient(f.x, f.y, 0, f.x, f.y, rad);
          g.addColorStop(0, `rgba(255,255,255,${0.12 * k})`);
          g.addColorStop(0.35, `rgba(255,230,140,${0.14 * k})`);
          g.addColorStop(1, `rgba(160,120,255,0)`);

          ctx.fillStyle = g;
          ctx.beginPath();
          ctx.arc(f.x, f.y, rad, 0, Math.PI * 2);
          ctx.fill();
        }
        ctx.restore();
      }

      if(!fw.length) return;

      ctx.save();
      ctx.globalCompositeOperation = 'lighter';
      ctx.lineCap = 'round';

      for(let i = fw.length - 1; i >= 0; i--){
        const p = fw[i];
        const age = now - p.t;
        const k = 1 - Math.min(1, age / p.life);

        if(k <= 0){
          fw.splice(i, 1);
          continue;
        }

        p.vx *= 0.985;
        p.vy *= 0.985;
        p.vy += 0.020 * (dt * 0.06);

        p.x += p.vx * (dt * 0.06);
        p.y += p.vy * (dt * 0.06);

        const alpha = p.a * k;

        ctx.strokeStyle = `rgba(${p.cr},${p.cg},${p.cb},${alpha * 0.48})`;
        ctx.lineWidth = p.r * 3.3;
        ctx.beginPath();
        ctx.moveTo(p.x, p.y);
        ctx.lineTo(p.x - p.vx * 3.2, p.y - p.vy * 3.2);
        ctx.stroke();

        ctx.fillStyle = `rgba(255,255,255,${alpha * 0.24})`;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r * 1.1, 0, Math.PI * 2);
        ctx.fill();
      }

      ctx.restore();
    }

    function setNYMode(on){
      const wasOn = document.body.classList.contains('ny');

      document.body.classList.toggle('ny', on);
      if(nyLabel) nyLabel.textContent = on ? '–í–∫–ª' : '–í—ã–∫–ª';

      // –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–∞–µ–º ‚Äî —Å—Ä–∞–∑—É –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º —Ç–µ–∫—É—â–∏–µ —Å–∞–ª—é—Ç—ã
      if(!on){
        fw.length = 0;
        fwFlash.length = 0;
      }

      if(on && mode !== 'snow'){
        mode = 'snow';
        rebuild();
      }

      if(!wasOn && on){
        triggerNYFireworks();
      }
    }

    // –ù–æ–≤—ã–π –≥–æ–¥ –≤—Å–µ–≥–¥–∞ —Å—Ç–∞—Ä—Ç—É–µ—Ç –≤—ã–∫–ª—é—á–µ–Ω–Ω—ã–º (–∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–∂–µ)
    try{ localStorage.removeItem('nyMode'); } catch {}
    setNYMode(false);

    nyToggle.addEventListener('click', () => {
      setNYMode(!document.body.classList.contains('ny'));
    });


    // ====== Premium mouse trail (static purple) ======
    const pointer = { x: W * 0.5, y: H * 0.35 };
    const trail = [];
    const sparks = [];

    const TRAIL_MAX = 120;
    const TRAIL_LIFE = 720;
    const TRAIL_MIN_DIST = 2.2;

    const SPARK_MAX = 140;
    const SPARK_LIFE = 420;

    function pushTrail(x, y){
      if (prefersReduced) return;

      const now = performance.now();

      if(trail.length === 0){
        trail.push({ x, y, t: now, s: 0 });
        return;
      }

      const last = trail[trail.length - 1];
      const dx = x - last.x;
      const dy = y - last.y;
      const dist = Math.hypot(dx, dy);
      if(dist < TRAIL_MIN_DIST) return;

      const dt = Math.max(8, now - last.t);
      const speed = dist / dt;

      trail.push({ x, y, t: now, s: speed });

      if(trail.length > TRAIL_MAX){
        trail.splice(0, trail.length - TRAIL_MAX);
      }

      if(speed > 0.55){
        const dir = Math.atan2(dy, dx);
        const count = Math.floor(clamp(speed * 6, 2, 6));
        for(let i = 0; i < count; i++){
          if(sparks.length > SPARK_MAX) break;

          const spread = rand(-0.9, 0.9);
          const a = dir + spread;
          const v = rand(1.4, 3.6) * (0.6 + speed);
          sparks.push({
            x, y,
            vx: Math.cos(a) * v,
            vy: Math.sin(a) * v,
            t: now,
            life: rand(SPARK_LIFE * 0.75, SPARK_LIFE * 1.15),
            r: rand(0.8, 1.9)
          });
        }
      }
    }

    function chaikin(points, iterations = 2){
      if(points.length < 3) return points.slice();

      let arr = points.map(p => ({ ...p }));
      for(let it = 0; it < iterations; it++){
        const out = [arr[0]];
        for(let i = 0; i < arr.length - 1; i++){
          const p0 = arr[i];
          const p1 = arr[i + 1];

          const q = {
            x: 0.75 * p0.x + 0.25 * p1.x,
            y: 0.75 * p0.y + 0.25 * p1.y,
            t: 0.75 * p0.t + 0.25 * p1.t,
            s: 0.75 * p0.s + 0.25 * p1.s
          };
          const r = {
            x: 0.25 * p0.x + 0.75 * p1.x,
            y: 0.25 * p0.y + 0.75 * p1.y,
            t: 0.25 * p0.t + 0.75 * p1.t,
            s: 0.25 * p0.s + 0.75 * p1.s
          };

          out.push(q, r);
        }
        out.push(arr[arr.length - 1]);
        arr = out;
      }
      return arr;
    }

    function updateAndDrawSparks(now, dt){
      if(sparks.length === 0) return;

      ctx.save();
      ctx.globalCompositeOperation = 'lighter';
      ctx.lineCap = 'round';

      for(let i = sparks.length - 1; i >= 0; i--){
        const sp = sparks[i];
        const age = now - sp.t;
        const k = 1 - clamp(age / sp.life, 0, 1);

        if(k <= 0){
          sparks.splice(i, 1);
          continue;
        }

        sp.vx *= 0.985;
        sp.vy = sp.vy * 0.985 + 0.0035 * dt;
        sp.x += sp.vx * (dt * 0.06);
        sp.y += sp.vy * (dt * 0.06);

        const alpha = 0.52 * k;
        ctx.strokeStyle = `rgba(160,120,255, ${alpha})`;
        ctx.lineWidth = sp.r * (1.2 + (1 - k));
        ctx.beginPath();
        ctx.moveTo(sp.x, sp.y);
        ctx.lineTo(sp.x - sp.vx * 1.8, sp.y - sp.vy * 1.8);
        ctx.stroke();
      }

      ctx.restore();
    }

    function drawTrail(now, dt){
      while(trail.length && (now - trail[0].t) > TRAIL_LIFE) trail.shift();
      if(trail.length < 2) return;

      const pts = chaikin(trail, 2);
      if(pts.length < 2) return;

      ctx.save();
      ctx.globalCompositeOperation = 'lighter';
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';

      const n = pts.length;

      for(let i = 1; i < n; i++){
        const a = pts[i - 1];
        const b = pts[i];

        const age = (now - b.t) / TRAIL_LIFE;
        const fade = clamp(1 - age, 0, 1);

        const prog = i / (n - 1);
        const sp = clamp(b.s * 2.6, 0, 1);

        const baseW = lerp(1.2, 6.0, Math.pow(prog, 0.9));
        const w = baseW * (0.75 + 0.65 * sp) * (0.55 + 0.45 * fade);

        const PURPLE_OUT = '160, 120, 255';
        const PURPLE_IN  = '135,  95, 235';

        ctx.strokeStyle = `rgba(${PURPLE_OUT}, ${0.075 * fade})`;
        ctx.lineWidth = w * 2.6;
        ctx.beginPath();
        ctx.moveTo(a.x, a.y);
        ctx.lineTo(b.x, b.y);
        ctx.stroke();

        ctx.strokeStyle = `rgba(${PURPLE_IN}, ${0.13 * fade})`;
        ctx.lineWidth = w * 1.25;
        ctx.beginPath();
        ctx.moveTo(a.x, a.y);
        ctx.lineTo(b.x, b.y);
        ctx.stroke();

        ctx.strokeStyle = `rgba(255,255,255,${0.085 * fade})`;
        ctx.lineWidth = Math.max(0.8, w * 0.35);
        ctx.beginPath();
        ctx.moveTo(a.x, a.y);
        ctx.lineTo(b.x, b.y);
        ctx.stroke();
      }

      const head = pts[n - 1];
      const headFade = clamp(1 - (now - head.t) / (TRAIL_LIFE * 0.7), 0, 1);
      const g = ctx.createRadialGradient(head.x, head.y, 0, head.x, head.y, 40);
      g.addColorStop(0, `rgba(255,255,255,${0.07 * headFade})`);
      g.addColorStop(0.35, `rgba(160,120,255,${0.10 * headFade})`);
      g.addColorStop(1, `rgba(160,120,255,0)`);
      ctx.fillStyle = g;
      ctx.beginPath();
      ctx.arc(head.x, head.y, 40, 0, Math.PI * 2);
      ctx.fill();

      ctx.restore();
      updateAndDrawSparks(now, dt);
    }

    // Pointer events: pointer + —Ö–≤–æ—Å—Ç
    window.addEventListener('pointermove', (e) => {
      pointer.x = e.clientX;
      pointer.y = e.clientY;
      pushTrail(e.clientX, e.clientY);
    }, { passive: true });

    window.addEventListener('pointerdown', (e) => {
      pointer.x = e.clientX;
      pointer.y = e.clientY;
      pushTrail(e.clientX, e.clientY);
      ensureAudio();
    }, { passive: true });

    // ====== Animation loop ======
    let lastT = performance.now();

    function loop(t){
      const dt = Math.min(32, t - lastT);
      lastT = t;

      ctx.clearRect(0, 0, W, H);

      const influenceRadius = 140;
      const ir2 = influenceRadius * influenceRadius;

      for(const p of particles){
        if(mode === 'snow'){
          p.wobble += p.wobbleSpeed * dt;
          const sway = Math.sin(p.wobble) * 0.35;

          const dx = p.x - pointer.x;
          const dy = p.y - pointer.y;
          const d2 = dx*dx + dy*dy;
          if(d2 < ir2){
            const k = (1 - d2 / ir2) * 0.35;
            p.x += (dx / Math.sqrt(d2 + 0.001)) * k * dt * 0.35;
          }

          p.x += (p.vx + sway) * dt * 0.06;
          p.y += p.vy * dt * 0.06;

          if(p.y - p.r > H) { p.y = -p.r; p.x = rand(0, W); }
          if(p.x < -20) p.x = W + 20;
          if(p.x > W + 20) p.x = -20;

          ctx.beginPath();
          ctx.fillStyle = `rgba(255,255,255,${p.alpha})`;
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fill();
        } else {
          p.tw += p.twSpeed * dt;
          const twinkle = (Math.sin(p.tw) * 0.25 + 0.75);
          const a = p.alpha * twinkle;

          const dx = pointer.x - p.x;
          const dy = pointer.y - p.y;
          const d2 = dx*dx + dy*dy;
          if(d2 < ir2){
            const k = (1 - d2 / ir2) * 0.08;
            p.x += (dx / Math.sqrt(d2 + 0.001)) * k * dt * 0.12;
            p.y += (dy / Math.sqrt(d2 + 0.001)) * k * dt * 0.12;
          }

          p.x += p.vx * dt * 0.06;
          p.y += p.vy * dt * 0.06;

          if(p.y < -10) p.y = H + 10;
          if(p.y > H + 10) p.y = -10;
          if(p.x < -10) p.x = W + 10;
          if(p.x > W + 10) p.x = -10;

          ctx.beginPath();
          ctx.fillStyle = `rgba(255,255,255,${a})`;
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fill();

          if(p.r > 1.5){
            ctx.beginPath();
            ctx.fillStyle = `rgba(124,92,255,${a * 0.12})`;
            ctx.arc(p.x, p.y, p.r * 4.2, 0, Math.PI * 2);
            ctx.fill();
          }
        }
      }

      // NY fireworks (draw above snow/stars)
      updateAndDrawFireworks(t, dt);

      // Mouse trail
      drawTrail(t, dt);

      requestAnimationFrame(loop);
    }

    if(!prefersReduced) requestAnimationFrame(loop);
  </script>
</body>
</html>
